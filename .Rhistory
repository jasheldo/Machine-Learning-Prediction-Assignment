library(lattice)
library(ggplot2)
library(rattle)
library(dplyr)
library(caret)
library(randomForest)
set.seed(35354)
setwd("~/GitHub/Machine-Learning-Prediction-Assignment")
traindata <- read.csv("pml-training.csv", header = TRUE, sep = ",", stringsAsFactors = TRUE, na.strings = "NA")
testdata <- read.csv("pml-testing.csv", header = TRUE, sep = ",", stringsAsFactors = TRUE, na.strings = "NA")
traindata <- tbl_df(traindata)
testdata <- tbl_df(testdata)
traindatasub <- select(traindata, -(kurtosis_roll_belt:var_yaw_belt),-(X:num_window),-(var_accel_arm:var_yaw_arm), -(kurtosis_roll_arm:amplitude_yaw_arm), -(kurtosis_roll_dumbbell:amplitude_yaw_dumbbell), -(var_accel_dumbbell:var_yaw_dumbbell), -(kurtosis_roll_forearm:amplitude_yaw_forearm), -(var_accel_forearm:var_yaw_forearm))
testdatasub <- select(testdata, -(kurtosis_roll_belt:var_yaw_belt),-(X:num_window),-(var_accel_arm:var_yaw_arm), -(kurtosis_roll_arm:amplitude_yaw_arm), -(kurtosis_roll_dumbbell:amplitude_yaw_dumbbell), -(var_accel_dumbbell:var_yaw_dumbbell), -(kurtosis_roll_forearm:amplitude_yaw_forearm), -(var_accel_forearm:var_yaw_forearm))
inTrain <- createDataPartition(y=traindatasub$classe, p=0.6,list=FALSE)
myTrain <- traindatasub[inTrain,]
myTest <- traindatasub[-inTrain,]
modFit <- randomForest(classe ~ .,data = myTrain)
print(modFit)
pmod <- predict(modFit, myTest, type = "class")
confusionMatrix(myTest$classe,pmod)
install.packages("e1071")
confusionMatrix(myTest$classe,pmod)
ptrain <- predict(modFit, myTrain, type = "class")
confusionMatrix(myTrain$classe,ptrain)
test_prediction <- predict(modFit, testdatasub, type = "class")
print(test_prediction)
fancyRpartPlot(modFit$finalModel,cex=0.5,under.cex=1,shadow.offset=0)
